// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}


enum userRole{  
  SUPERADMIN
  SEKRETARIAT
  BUKUWISUDA
  PETUGAS
}

model user {
  id_user   Int      @id @default(autoincrement())
  username  String   @unique
  email     String   @unique
  password  String
  role      userRole  @default(SUPERADMIN)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  files     file[]
}



model mahasiswa {
  nim               Int               @id
  nama              String
  prodi             String?
  kelas             String
  no_telp           String?
  penempatan        String?
  nama_orang_tua    String?
  judul_skripsi     String?
  dosen_pembimbing  String?
  daerah_asal       String?
  daerah_penempatan String?
  createdAt         DateTime          @default(now())
  updatedAt         DateTime          @updatedAt
  presensis         presensi[]
  emailSendStatuses emailSendStatus[]
  files             file[]
}

model tamu {
  id_tamu           Int               @id @default(autoincrement())
  nama              String
  email             String
  asal_instansi     String
  presensis         presensi[]
  emailSendStatuses emailSendStatus[]
}

model presensi {
  id_presensi    Int      @id @default(autoincrement())
  waktu_presensi DateTime @default(now())
  status         Int      @default(0)

  mahasiswa mahasiswa? @relation(fields: [nim], references: [nim])
  nim       Int?

  tamu    tamu? @relation(fields: [id_tamu], references: [id_tamu])
  id_tamu Int?
}

model emailSendStatus {
  id_sendStatus Int        @id @default(autoincrement())
  waktu_dikirim DateTime   @default(now())
  status        Int        @default(0)
  email         String
  mahasiswa     mahasiswa? @relation(fields: [nim], references: [nim])
  nim           Int?
  tamu          tamu?      @relation(fields: [id_tamu], references: [id_tamu])
  id_tamu       Int?
}

model file {
  id_file   Int        @id @default(autoincrement())
  file_name String
  path      String
  type      String
  mahasiswa mahasiswa? @relation(fields: [nim], references: [nim])
  nim       Int?
  user      user?      @relation(fields: [id_user], references: [id_user])
  id_user   Int?
}


